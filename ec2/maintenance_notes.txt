Rebooting a Master Server
	make a snapshot of the pd volume

	start up a new slave:
	update master server IP address
		sudo nano /etc/fstab 
		sudo mount -a
		sudo nano ~www/slave
		regenerate www's nginx.conf
		sudo service nginx restart
	update sources
		git pull --rebase
		cd libs; sh checkouts
	update site-down
		disable popvox.middleware.AdserverTargetsMiddleware because it checks db
		edit urls.py to turn on site-down page
		edit templates/static/site_down.html to update maintenance notice
	./fcgi
	
	on the master:
	./fcgi stop
	
	requests should kick over to the slave automatically
	
	re-associate the elastic IP with the slave
	
	wait for snapshot to complete
	
	once MySQL on the master goes down, the slave can't be restarted because
	Django will do model validation on startup which accesses MySQL
	
	sudo apt-get update && apt-get dist-upgrade
	
	reboot the master instance
	
	restart services:
	git daemon --base-path=/mnt/persistent/ --export-all --detach --enable=receive-pack /mnt/persistent/
	sudo searchd
	./fcgi for each user
	
	move the elastic IP back
	
	shut down the slave

Building a new Master Server

	the mysql anacron will break if the debian-sys-maint mysql user's password doesn't match
	the password listed in /etc/mysql/debian.cnf. to fix, grab that password and run:
	GRANT RELOAD, SHUTDOWN, PROCESS, SHOW DATABASES, SUPER, LOCK TABLES ON *.* TO 'debian-sys-maint'@'localhost' IDENTIFIED BY PASSWORD 'xxxxxxxxxxxxxxxx'
	(ref: http://www.lornajane.net/posts/2008/Logrotate-Error-on-Ubuntu)

