ServerName www.popvox.com
NameVirtualHost *:443
Listen 444
Listen 555
Listen 777

AddType font/x-woff .woff

ExtendedStatus On

<Directory />
    AllowOverride All
</Directory>

<VirtualHost *:80>
    # This virtual host redirects all popvox domain
    # names to our canonical SSL host. The first vhost
    # is the default for the server, so it should
    # be this one.
	
    ServerAdmin hostmaster@occams.info
    DocumentRoot /home/www/sources/site/httproot
    ServerName popvox.com
    ServerAlias www.popvox.com
    ServerAlias thevoxpop.us
    ServerAlias www.thevoxpop.us
    ServerAlias popvox.net
    ServerAlias www.popvox.net
    
    ErrorLog /home/www/logs/error_log
    CustomLog /home/www/logs/access_log combined
    
    RedirectMatch    ^/blog$ /blog/
    ProxyPass        /blog/  http://blog.popvox.com/blog/
    ProxyPassReverse /blog/  http://blog.popvox.com/blog/

    Redirect / https://www.popvox.com/
</VirtualHost>

<VirtualHost *:443>
    # This serves as the default host for SSL connections.
    # We only support SSL on "www.popvox.com" so we catch
    # other names and redirect to our home. This requires
    # us to set NameVirtualHost *:443 also.

    ServerAdmin hostmaster@occams.info
    DocumentRoot /home/www/sources/site/httproot
    ServerName invalid.popvox.com
    
    ErrorLog /home/www/logs/error_log
    CustomLog /home/www/logs/access_log combined
    
    RedirectMatch . https://www.popvox.com/

    SSLEngine On
    SSLCertificateFile /mnt/persistent/ssl/www_popvox_com.crt
    SSLCertificateKeyFile /mnt/persistent/ssl/www_popvox_com.key
    SSLCertificateChainFile /mnt/persistent/ssl/gd_bundle.crt
</VirtualHost>

<VirtualHost *:80>
    # shorturl redirects
	
    ServerAdmin hostmaster@occams.info
    DocumentRoot /home/www/sources/site/httproot
    ServerName pvox.co
    ServerAlias pvox.us
    ServerAlias www.pvox.co
    ServerAlias www.pvox.us
    
    ErrorLog /home/www/logs/error_log
    CustomLog /home/www/logs/access_log combined
    
    Redirect / https://www.popvox.com/shorturl/
</VirtualHost>

<VirtualHost *:80>
    ServerAdmin hostmaster@occams.info
    DocumentRoot /home/www/sources/site/httproot
    ServerName g.popvox.com
    
    ErrorLog /home/www/logs/error_log
    CustomLog /home/www/logs/access_log combined
    
    Redirect / http://mail.g.popvox.com
</VirtualHost>

   # this one must go first so port 443's default vhost is this
Include /home/www/httpd.conf

Include /home/josh/httpd.conf
Include /home/william/httpd.conf
Include /home/william/sources/oughttabealaw/httpd.conf

# The following is the template used for instances
# of the website.

##<VirtualHost _default_:443>
##    ServerAdmin hostmaster@occams.info
##    DocumentRoot /home/__USER__/sources/site/httproot
##    ServerName __USER__.popvox.com
##    
##    ErrorLog /home/__USER__/logs/error_log
##    CustomLog /home/__USER__/logs/access_log combined
##
##    RedirectMatch    ^/blog$ /blog/
##    ProxyPass        /blog/  http://blog.popvox.com/blog/
##    ProxyPassReverse /blog/  http://blog.popvox.com/blog/
##
##    Alias /media/ /home/__USER__/sources/site/media/
##    Alias /robots.txt /home/__USER__/sources/site/httproot/robots.txt
##    Alias /favicon.ico /home/__USER__/sources/site/media/favicon.ico
##    Alias /admin_media/ /usr/share/pyshared/django/contrib/admin/media/
##    Alias /files/ /home/__USER__/sources/site/httproot/files/
##    Alias /media_kit/ /home/__USER__/sources/site/httproot/media_kit/
##
##    WSGIDaemonProcess popvox-__USER__
##    WSGIProcessGroup popvox-__USER__
##    WSGIScriptAlias / /home/__USER__/sources/site/django.wsgi
##
##    SSLEngine On
##    SSLCertificateFile /mnt/persistent/ssl/www_popvox_com.crt
##    SSLCertificateKeyFile /mnt/persistent/ssl/www_popvox_com.key
##    SSLCertificateChainFile /mnt/persistent/ssl/gd_bundle.crt
##
##    #Remove this in the production site.
##    <LocationMatch ^/home|^/bills|^/orgs|^/accounts>
##        AuthType Basic
##        AuthName "Private Beta"
##        AuthUserFile /home/william/sources/htpasswd
##        Require user demo
##    </LocationMatch>
##
##    ## Not sure how to make this work...
##    #SSLVerifyClient require
##    #SSLVerifyDepth 1
##    #SSLCACertificateFile /mnt/persistent/ssl/www_popvox_com.crt
##
##    ExpiresActive on
##    ExpiresByType image/gif A900
##    ExpiresByType image/jpg A900
##    ExpiresByType image/png A900
##    ExpiresByType text/css A900
##    ExpiresByType text/javascript A900
##</VirtualHost>
