{% extends "master.html" %}
{% load cache %}
{% load popvox_utils %}
{% block title %}Bills in Congress by Issue Area{% endblock%}
{%block nav_legstaff_class_bills%}active{%endblock%}
{%block nav_orgadmin_class_bills%}active{%endblock%}
{%block nav_citzen_class_bills%}active{%endblock%}
{% block head %}
<style>
#issue_list {
	background-color: white;
}	
#issue_list .controller {
	padding: 10px;
	text-align: right;
	font-size: 11px;
	color: #666;
}
	#issue_list .controller div {
		display: inline-block;
		padding-left: 10px;
		cursor: pointer;
	}
	#issue_list .controller div.active {
		font-weight: bold;
		cursor: default;
	}
#issue_list .issue {
	padding: 10px;
	cursor: pointer;
}
	#issue_list .issue:hover {
		background-color: #EFE;
	}
	#issue_list .issue.active {
		background-color: #E47816;
		color: white;
	}
	#issue_list .issue.active .count {
		color: white;
	}
#issue_list .issue .name {
	font-weight: bold;
}
#issue_list .issue .count {
	font-style: italic;
	color: #888;
}

#bill_list {
}
#bill_list .heading h3.first {
	background: none;
	padding-top: 0;
	margin-top: 0;
}
</style>
<script>
$(function() {
		$('#issue_list .controller div').click(function() {
			$('#issue_list .controller div').removeClass('active');
			$(this).addClass('active');
			
			var compare_attr = this.id;
			$('#issue_list .issues .issue').sortElements(function(a,b) { return parseInt($(a).attr(compare_attr)) > parseInt($(b).attr(compare_attr)) ? 1 : -1 });
		});
		
		$('#issue_list .issue').click(function() {
			$('#bill_list').html("<p>Loading...</p>");
			$('#issue_list .issue').removeClass("active");
			$(this).addClass("active");
			
			$.ajax({ 
				type: "GET",
				url: "/ajax/bills/issue-area",
				data: { ix: this.getAttribute('ix')},
				success:
					function(data) {
						$('#bill_list').html(data);
					},
				error:
					function(data) {
						$('#bill_list').html("<p>There was an error loading the page. Please try again.</p>");
					}
			});
		});
});
</script>
{% endblock %}
{% block content %}
<div class="content">
	
	<div class="col_9 col_top">
		<h1>Issue Areas</h1>
		
		<p>The Library of Congress categorizes all bills before Congress into these issue areas.</p>
	</div>

	{% include "ads/rightbar.html" %}

	<div class="col_12 col_top col_last">
		<div id="issue_list" class="col_3">
			<div class="controller">
				<div id="sort_alph" class="active">alphabetical</div>
				<div id="sort_pop">most popular</div>
			</div>
			<div class="issues">
			{% for ix in issues %}
				<div class="issue" sort_alph="{{ix.primaryorder}}" sort_pop="-{{ix.commentcount}}" ix="{{ix.id}}">
					<span class="name">{{ix.name}}</span>
					<span class="count">({{ix.billcount}})</span>
				</div>
			{% endfor %}
			</div>
		</div>
	
		<div id="bill_list" class="col_9 col_last">
		</div>
	</div>
</div>

{% endblock %}

