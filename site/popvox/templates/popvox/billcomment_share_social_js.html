{% load popvox_utils %}
{% load registration_providers %}
{% load humanize %}
<script>
var working = false;
function share(method) {
	if (method == "email" && $('#share_email_field').hasClass("default")) {
		alert("Enter some email addresses.");
		return;
	};
	working = true;
	ajax("/ajax/bills/share",
		{ "bill": {{bill.id}}, "comment": {{comment.id}}, "message": $('#share_message').val(), "method": method, "emails": $('#share_email_field').val() },
		{ "savebutton": "share_" + method + "_button",
		   "statusfield": "share_" + method + "_status",
		   "success": function() {
			   working = false;
			   if (method == "email") { $('#share_email_field').val(''); $('#share_email_field').blur(); }
			   $("#share_" + method + "_status").delay(1000).fadeOut();
		   },
		   "failure": function() {
			   working = false;
		   },
		});
	return false;
}
function share_tab(method) {
	$('#sharetab_email').hide();
	$('#sharetab_facebook').hide();
	$('#sharetab_twitter').hide();
	
	if (method == "email" {% if twitter %}|| method == "twitter"{% endif %} {% if facebook %}|| method == "facebook"{% endif %})
		$('#sharetab_message').fadeIn();
	else
		$('#sharetab_message').hide();
	
	if (method == "email")
		$('#sharetab_message h3').text("Personalized Message To Recipients");
	if (method == "facebook")
		$('#sharetab_message h3').text("Wall Post");
	if (method == "twitter")
		$('#sharetab_message h3').text("Tweet");
	$('#sharetab_' + method).fadeIn();
	return false;
}
if (window.location.hash == "#twitter" || window.location.hash == "#facebook") {
	$(function() {
		share_tab(window.location.hash.substring(1));
		$(window).scrollTop($('.social_share_btns').offset().top - 150);
	});
}
</script>

