{% extends "master.html" %}
{% load cache %}
{% load popvox_utils %}
{% block title %}Bills in Congress{% endblock%}
{%block nav_legstaff_class_bills%}active{%endblock%}
{%block nav_orgadmin_class_bills%}active{%endblock%}
{%block nav_citzen_class_bills%}active{%endblock%}
{% block head %}
<script type="text/javascript" src="/media/js/highcharts.js"></script>
<script type="text/javascript" src="/media/js/charts.js"></script>
<script>
$(function() {
	$.ajax({
		type:"POST",
		url: "/ajax/activity",
		data: {
			count: 5
		},
		complete: function(res, status) {
			$('#activity').html(res.responseText);
		}
	});
});
</script>
<style>
.category_icon_container {
    background: url("/media/master/bg_rule.gif") repeat-x left top;
	padding: 20px 0 0 80px;
}
.category_icon_container h2 {
	font: normal 24px/24px 'BebasNeueRegular', helvetica, arial, sans-serif;
	letter-spacing: 1px;
	text-transform: uppercase;
}
.category_icon {
	float: left;
	width: 80px;
	height: 80px;
	margin-left: -80px;
}
.category_icon_governance { background: url("/media/icons_categories/legis.png") no-repeat left top; }
.category_icon_guns { background: url("/media/icons_categories/gun.png") no-repeat left top; }
.category_icon_money { background: url("/media/icons_categories/tax.png") no-repeat left top; }
.category_icon_health { background: url("/media/icons_categories/health.png") no-repeat left top; }
.category_icon_technology { background: url("/media/icons_categories/chip.png") no-repeat left top; }
.category_icon_immigration { background: url("/media/icons_categories/immig.png") no-repeat left top; }
.category_icon_environment { background: url("/media/icons_categories/environment.png") no-repeat left top; }
.category_icon_international { background: url("/media/icons_categories/international.png") no-repeat left top; }

.userrichtextcontent a {
	border-bottom: 1px solid #CC6A11;
}
.category_icon_container ul li {
	background-image: none;
	padding-left: 0;
	margin-left: 0;
}
.category_icon_container small {
	xxx-display: block;
	font-style: normal;
	font-size: 12px;
}

.rightcol small {
	font-style: normal;
}
.userrichtextcontent small a {
	color: #AA7733;
	border-bottom: 1px solid #BBAA88;
}
</style>
{% endblock %}
{% block content %}

<div class="content">
	
	<div class="col_9 col_top">
		<h1>What do you think about these bills?</h1>
		
		<p id="anonymous" style="margin-bottom: 2em; display: none;">With POPVOX, you can voice your concerns on specific bills in a format that is tailored for Congress.</p>
		
		<script>master_state(function(res) {
			if (res.user && res.user.legstaffrole) $('.content h1').text("Bills in Congress");
			if (!res.user) $('#anonymous').show();
		});</script>
		
		<iframe src="/widgets/top-bills" width="700" height="150" frameborder="0" scrolling="no" style="margin-bottom: 15px"> </iframe>
		
	</div>

	{% include "ads/rightbar.html" %}

	<div class="col_7" id="activity_container">
		<div style="padding-right: 20px">
			<div id="highlights">
				<h3 class="no_rule">Highlights</h3>
				<div class="userrichtextcontent">
					{% rawtext "bills_left" %}
				</div>
				
				<div class="clear block bill_search search_orange" style="margin-top: 30px; float: right">
					<div class="search_box">
						<p style="float: none"><strong>Bill Search</strong> {% comment %} <span>search by bill number or keyword</span>{% endcomment %}</p> 
						{% include "popvox/billsearch_form.html" %}
						{% comment %}<p class="help">Don&rsquo;t know what to search for? Use the <a href="/orgs">Organization Directory</a> to find legislation tracked by organizations you support.</p>{% endcomment %}
					</div>
				</div>
				
				<h3 class="no_rule clear">Recent Activity</h3>
				<div class="hr"> </div>
				
				<div id="activity"> </div>

				<div style="text-align: center">
					(<a href="/activity">more</a>)
				</div>
				
			</div>
		</div>
	</div>
		
	<div id="trending_bills" class="col_5 col_last bills">
		<h3 class="no_rule" style="background: url(/media/master/bg_rule.gif) repeat-x scroll left bottom transparent; padding-bottom: 14px;">Trending Bills</h3>
		{% for billrec in trending_bills %}
			
			<div class="bill {% if billrec.pos == "+" %}endorsed{% endif %} {% if billrec.pos == "-" %}opposed{% endif %}" {% if forloop.first %}style="background: url(/media/master/bg_bills.png) no-repeat scroll left -1px transparent;"{% endif %}>
				{% comment %}{% ifchanged %}<p style="margin-top: -40px; text-align: right"><em>in the last {{billrec.bill.trending_time_period}}</em></p>{% endifchanged %}{% endcomment %}
				
				{% with billrec.bill as bill %}
				
				{% if billrec.pos == "" %}
				<a class="action" href="{{bill.url}}" style="float: right; margin-left: 15px">Action</a>
				{% endif %}
				
				<h5 {% if not bill.sponsor %}style="margin-bottom: 25px"{% endif %}><a href="{{billrec.bill.url}}">{{ billrec.bill.nicename|truncatewords:12 }}</a></h5>
				{% if bill.sponsor %}
				<p style="margin-top: 4px; font-size: 11px">Sponsored by {{ bill.sponsor.name }}.</p>
				{% endif %}
				
				
				<div class="bill_detail">
				
				{% if billrec.bill.new_positions < 50 %}
					<p style="margin-top: -10px;"><strong>trending in the last {{billrec.bill.trending_time_period}}!</strong></p>
				{% else %}
					<p style="margin-top: -10px;"><strong>{{billrec.bill.new_positions}}</strong> people wrote Congress about this {{billrec.bill.proposition_type}} in the last {{billrec.bill.trending_time_period}}!</p>
				{% endif %}
				
				{% comment %}
				<p><strong>Status:</strong>
				<em>{{bill.status}}</em></p>

				{% if bill.description %}<p class="bill_detail">{{ bill.description|truncatewords:18 }}</p>{% endif %}
				
				{% for org in billrec.orgs %}
				<div class="bill_endorseoppose">
					<p>
						{% if org.position == "+" %}Endorsed{% endif %}
						{% if org.position == "-" %}Opposed{% endif %}
						by
						<a href="{{org.url}}">{{org.name}}</a>
					</p>
					{% for cam in org.campaigns %}
						<p style="margin-left: 1.5em"><a href="{{cam.url}}">{{cam.name}}</a>{% if cam.description %}: {{ cam.description|truncatewords:50 }}{% endif %}</p>
					{% endfor %}
				</div>
				{% endfor %}
				{% endcomment %}
				
				</div>
			</div>
			
			{% endwith %}
			
		{% empty %}
		
			<p>We will list trending bills as our users begin weighing in on the new bills introduced by the new Congress.</p> 
			
		{% endfor %}
	</div>
		
</div>
		    
{% endblock %}

